<app-sidebar></app-sidebar>
<div class="container-fluid ps-6">
  <app-dashboard-head></app-dashboard-head>
  <div class="container-fluid mt-5">
    <div class="row">
      <h4>Orders</h4>
    </div>
  </div>
  <div class="order-body">
    <form class="order-search-panel">
      <input
        class="order-search form-control"
        type="search"
        placeholder="Search Order"
        aria-label="Search"
        name="search"
        [(ngModel)]="search"
        (keyup)="searchOrder($event.target)"
      />
      <button
        type="button"
        class="btn order-table-btn btn-search-panel"
        routerLink="/addOrder"
      >
        + Add
      </button>
    </form>
  </div>

  <div class="order-table overflow-x-auto text-nowrap">
    <table class="table table-fixed table-responsive text-center">
      <thead>
        <tr>
          <th scope="col" class="col-1">ID</th>
          <th scope="col" class="col-3">Customer Name</th>
          <th scope="col" class="col-3">Product Name</th>
          <th scope="col" class="col-2">Price</th>
          <th scope="col" class="col-2">Assign Designer</th>
          <th scope="col" class="col-2">Assign Production</th>
          <th scope="col" class="col-2">Assign Plate Setter</th>
          <th scope="col" class="col-3">Action</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td class="order-table-404" colspan="8" *ngIf="tableData">
            No record found
          </td>
        </tr>
        <tr *ngFor="let order of ordersArray" class="order-table-row-hover">
          <th scope="row" class="tracking-id">{{ order?.id }}</th>
          <td>{{ order?.customer?.name }}</td>
          <td>{{ order?.product }}</td>
          <td>Rs. {{ order?.price }}</td>
          <td>
            {{ order?.designer?.email }}
          </td>
          <td>
            {{ order?.production?.email }}
          </td>
          <td>
            {{ order?.plateSetter?.email }}
          </td>
          <td class="order-table-btns-container">
            <div class="btn-group mr-2" role="group" aria-label="Second group">
              <button
                type="button"
                class="btn order-table-btn"
                (click)="viewOrder(order.id)"
              >
                <i class="fa-solid fa-hand-pointer"></i>&nbsp;<small
                  >View</small
                >
              </button>
              <button
                type="button"
                class="btn order-table-btn"
                (click)="editOrder(order.id)"
              >
                <i class="fa-solid fa-pen"></i>&nbsp;<small>Edit</small>
              </button>
              <button
                type="button"
                class="btn order-table-btn"
                (click)="deleteOrder(order.id)"
              >
                <i class="fa-solid fa-trash"></i>&nbsp;<small>Delete</small>
              </button>
              <button
                type="button"
                class="btn order-table-btn"
                (click)="assignOrder(order.id)"
              >
                <i class="pi pi-plus"></i>&nbsp;<small>Assign Order</small>
              </button>
              <button
                type="button"
                class="btn order-table-btn"
                (click)="orderProcessCtp(order?.id)"
              >
                <i class="pi pi-list"></i>&nbsp;<small>Order Process Ctp</small>
              </button>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <p-dialog
    header="Assign Order To User"
    [(visible)]="visible"
    [breakpoints]="{ '960px': '75vw' }"
    [style]="{ width: '50vw' }"
    [draggable]="false"
    [resizable]="false"
  >
    <div class="row mx-auto my-3">
      <div class="col-6">
        <label class="d-block add-order-label m-0">Select Role</label>
        <p-dropdown
          styleClass="w-100"
          appendTo="body"
          [options]="roleArray"
          [(ngModel)]="selectedRole"
          (onChange)="getUsersByRole($event.value)"
          placeholder="Select a Role"
          optionLabel="name"
        ></p-dropdown>
      </div>
      <div class="col-6">
        <label class="d-block add-order-label m-0">Select User</label>
        <p-dropdown
          styleClass="w-100"
          appendTo="body"
          [options]="userArray"
          [filter]="true"
          filterBy="name"
          [(ngModel)]="selectedUser"
          placeholder="Select a User"
          emptyMessage="Select a role first"
          optionLabel="name"
        ></p-dropdown>
      </div>
    </div>
    <div class="text-danger row ms-3" *ngIf="plzSelect">
      Please Assign then Save
    </div>
    <div class="d-flex justify-content-end me-3">
      <button
        class="btn btn-dark"
        (click)="saveOrder(selectedUser, selectedRole, selectedOrderId)"
      >
        Save
      </button>
    </div>
  </p-dialog>
  <p-toast></p-toast>
  <!-- <p-dialog
    header="Chose the option"
    [(visible)]="processOptions"
    [breakpoints]="{ '960px': '75vw' }"
    [style]="{ width: '50vw' }"
    [draggable]="false"
    [resizable]="false"
  >
    <div class="row">
      <div class="col text-center">
        <button class="btn btn-dark px-3" (click)="orderProcessCtp()">
          Order Process Ctp
        </button>
      </div>
      <div class="col-4 text-center">
        <button class="btn btn-dark px-3" (click)="orderProcessPress()">
          Order Process Press
        </button>
      </div>
      <div class="col-4">
        <button class="btn btn-dark px-3" (click)="orderProcessPaperMarket()">
          Order Process Press
        </button>
      </div>
    </div>
  </p-dialog> -->
</div>
